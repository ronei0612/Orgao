const notasFrequencias={a:110,a_:116.54,b:123.47,c:130.81,c_:138.59,d:146.83,d_:155.56,e:164.81,f:174.61,f_:185,g:196,g_:207.65,a1:220,a_1:233.08,b1:246.94,c1:261.63,c_1:277.18,d1:293.67,d_1:311.13,e1:329.63,f1:349.23,f_1:369.99,g1:392,g_1:415.3},primeiraGuitar=new Pizzicato.Sound({source:"wave",options:{type:"sawtooth",frequency:notasFrequencias.c1,release:2.5,attack:.4,volume:.01}}),quintaGuitar=new Pizzicato.Sound({source:"wave",options:{type:"sawtooth",frequency:notasFrequencias.g1,release:2.5,attack:.4,volume:.01}}),distortion=new Pizzicato.Effects.Distortion({gain:.5,mix:.5});var _grupoNotas,_grupoNotasStrings,timer,_acordeBaixo,_acordeNotas,_notasSolo,_spanBotaoFecharModalPositions,_sourceChimbalAberto,_sourceBaixo,_configuracaoElemento,_configuracaoEvento,_notasAcordesJson,_acordesCampoHarmonicoJson,_acidentesCorrespondentesJson,_acordesTons,_tonsMaiores,_tonsMenores,flanger=new Pizzicato.Effects.Flanger({time:.45,speed:.2,depth:.1,feedback:.1,mix:.5}),reverb=new Pizzicato.Effects.Reverb({time:2,decay:2,reverse:!1,mix:.5});primeiraGuitar.addEffect(distortion),primeiraGuitar.addEffect(flanger),primeiraGuitar.addEffect(reverb),quintaGuitar.addEffect(distortion),quintaGuitar.addEffect(flanger),quintaGuitar.addEffect(reverb);var _acordeSelecionado="",_acordeAntesSelecionado="",_acompanhamentoSelecionado="",_acompanhamentoSolo=!1,_acompanhamentoFull=!1,_acompanhamentoMao=!1,_volume=.9,_instrumentoSelecionado="orgao",_stringsSelecionado=!1,_baixoSelecionado=!1,_violaoSelecionado=!1,_epianoSelecionado=!1,_guitarraSelecionado=!1,_guitarraParado=!0,_stringsParado=!0,_autoMudarRitmo=!1,_orientacaoCelularPe=!0,_tomSelectedIndexCifra=0,_tomIndex="",_cifraId=0,_cifraParado=!0,_chimbalIsAberto=!1,_cravoSelecionado=!0,_viradaRitmo="",_trocarRitmo=!1,_configurandoTeclas=!1,_teclasConfiguracao={},_gravarCifras=!1,_chimesPressionado=!1;const eventoClick=new Event("click"),eventoChange=new Event("change"),eventoMousedown=new Event("mousedown"),eventoMouseup=new Event("mouseup"),eventoTouchstart=new Event("touchstart"),eventoInput=new Event("input"),eventos={eventoClick:eventoClick,eventoChange:eventoChange,eventoMousedown:eventoMousedown,eventoMouseup:eventoMouseup,eventoTouchstart:eventoTouchstart,eventoInput:eventoInput};var notasAcordes=Object.keys(notasAcordesJson);const selectConfiguracao=document.getElementById("selectConfiguracao"),instrumentoSelect=document.getElementById("instrumentoSelect"),autoCheck=document.getElementById("autoCheck"),autoCheckDiv=document.getElementById("autoCheckDiv"),acompCheck=document.getElementById("acompCheck"),acompCheckDiv=document.getElementById("acompCheckDiv"),bpm=document.getElementById("bpm"),selectRitmo=document.getElementById("selectRitmo"),botaoBuscar=document.getElementById("botaoBuscar"),play_pause=document.getElementById("play_pause"),bpmRange=document.getElementById("bpmRange"),chimbal=document.getElementById("chimbal"),brush=document.getElementById("brush"),meiaLua=document.getElementById("meiaLua"),prato=document.getElementById("prato"),iconPrato=document.getElementById("iconPrato"),iconChimes=document.getElementById("iconChimes"),aro=document.getElementById("aro"),caixa=document.getElementById("caixa"),cravo=document.getElementById("cravo"),pratoCravo=document.getElementById("pratoCravo"),iconPratoCravo=document.getElementById("iconPratoCravo"),iconChimesCravo=document.getElementById("iconChimesCravo"),brushCravo=document.getElementById("brushCravo"),stringsBotao=document.getElementById("stringsBotao"),violaoBotao=document.getElementById("violaoBotao"),pianoBotao=document.getElementById("pianoBotao"),baixoBotao=document.getElementById("baixoBotao"),tomSelect=document.getElementById("tomSelect"),volumeTexto=document.getElementById("volumeTexto"),textoCifras=document.getElementById("textoCifras"),textoAcordeMenor=document.getElementById("textoAcordeMenor"),textoCifrasFrame=document.getElementById("textoCifrasFrame"),container=document.getElementById("container"),voltar=document.getElementById("voltar"),botaoFonte=document.getElementById("botaoFonte"),selectFonte=document.getElementById("selectFonte"),tomMenorSwitchDiv=document.getElementById("tomMenorSwitchDiv"),orgaoCifrasBotoes=document.getElementById("orgaoCifrasBotoes"),tdVolume=document.getElementById("tdVolume"),volumeDiv=document.getElementById("volumeDiv"),textoVolume=document.getElementById("textoVolume"),volumeInput=document.getElementById("volumeInput"),cifraAvancar=document.getElementById("cifraAvancar"),cifraRepetir=document.getElementById("cifraRepetir"),cifraRetroceder=document.getElementById("cifraRetroceder"),exitfullscreen=document.getElementById("exitfullscreen"),fullscreenDiv=document.getElementById("fullscreenDiv"),botaoFullscreen=document.getElementById("botaoFullscreen"),trackerControls=document.getElementById("trackerControls"),bateria=document.getElementById("bateria"),linhaSelectTom=document.getElementById("linhaSelectTom"),navBar=document.getElementById("navBar"),oracoesEucaristicasDiv=document.getElementById("oracoesEucaristicasDiv"),acorde_10=document.getElementById("acorde_10"),acorde_7=document.getElementById("acorde_7"),acorde_9=document.getElementById("acorde_9"),muteDiv=document.getElementById("muteDiv"),botaoMute=document.getElementById("botaoMute"),iconVolumeMute=document.getElementById("iconVolumeMute"),iconVolume=document.getElementById("iconVolume"),modal01=document.getElementById("modal01"),linksCifraClubList=document.getElementById("linksCifraClubList"),botaoIniciar=document.getElementById("botaoIniciar"),escreverCifraTextArea=document.getElementById("escreverCifraTextArea"),selectInstrumento=document.getElementById("selectInstrumento"),salvarDiv=document.getElementById("salvarDiv"),compartilhadoDiv=document.getElementById("compartilhadoDiv"),compartilharDiv=document.getElementById("compartilharDiv"),selectOpcoes=document.getElementById("selectOpcoes"),modalGravar=document.getElementById("modalGravar"),musicaSearch=document.getElementById("musicaSearch"),titulo=document.getElementById("titulo"),bateriaBotoes=document.getElementById("bateriaBotoes"),selectSalvamento=document.getElementById("selectSalvamento"),lightCompasso=document.getElementById("lightCompasso"),modal_loading=document.getElementById("modal_loading"),prepararBateriaBotao=document.getElementById("prepararBateriaBotao"),pararBateriaBotao=document.getElementById("pararBateriaBotao"),play_pause_bateria=document.getElementById("play_pause_bateria"),textoRitmo=document.getElementById("textoRitmo"),listaMusicasCifra=document.getElementById("listaMusicasCifra"),orgaoBox=document.getElementById("orgaoBox"),notaTuner=document.getElementById("notaTuner"),tunerDiv=document.getElementById("tunerDiv"),autoTunerCheck=document.getElementById("autoTunerCheck"),liturgiaDiariaDiv=document.getElementById("liturgiaDiariaDiv"),violinoDesenho=document.getElementById("violinoDesenho"),violaoDesenho=document.getElementById("violaoDesenho"),switchDark=document.getElementById("switchDark"),baixo=document.getElementById("baixo"),mao=document.getElementById("mao"),full=document.getElementById("full"),measureLength=document.getElementById("measureLength"),musicaAcordesTextArea=document.getElementById("musicaAcordesTextArea"),acorde_0=document.getElementById("acorde_0"),acorde_3=document.getElementById("acorde_3"),acorde_4=document.getElementById("acorde_4"),acorde_5=document.getElementById("acorde_5"),acorde_1=document.getElementById("acorde_1"),acorde_2=document.getElementById("acorde_2"),aumentarTomMais=document.getElementById("aumentarTomMais"),diminuirTomMenos=document.getElementById("diminuirTomMenos"),tomMenorSwitch=document.getElementById("tomMenorSwitch"),tituloConfiguracaoTeclas=document.getElementById("tituloConfiguracaoTeclas"),textoConfiguracao=document.getElementById("textoConfiguracao"),tecladoTeclasDiv=document.getElementById("tecladoTeclasDiv"),inputTeclaLabel=document.getElementById("inputTeclaLabel"),elementos={instrumentoSelect:instrumentoSelect,autoCheck:autoCheck,bpm:bpm,selectRitmo:selectRitmo,botaoBuscar:botaoBuscar,play_pause:play_pause,bpmRange:bpmRange,chimbal:chimbal,brush:brush,meiaLua:meiaLua,prato:prato,aro:aro,caixa:caixa,cravo:cravo,brushCravo:brushCravo,pratoCravo:pratoCravo,stringsBotao:stringsBotao,violaoBotao:violaoBotao,pianoBotao:pianoBotao,baixoBotao:baixoBotao,tomSelect:tomSelect,volumeTexto:volumeTexto,textoCifras:textoCifras,textoAcordeMenor:textoAcordeMenor,textoCifrasFrame:textoCifrasFrame,container:container,voltar:voltar,botaoFonte:botaoFonte,selectFonte:selectFonte,tomMenorSwitchDiv:tomMenorSwitchDiv,orgaoCifrasBotoes:orgaoCifrasBotoes,tdVolume:tdVolume,volumeDiv:volumeDiv,textoVolume:textoVolume,volumeInput:volumeInput,cifraAvancar:cifraAvancar,cifraRepetir:cifraRepetir,cifraRetroceder:cifraRetroceder,exitfullscreen:exitfullscreen,fullscreenDiv:fullscreenDiv,botaoFullscreen:botaoFullscreen,trackerControls:trackerControls,bateria:bateria,linhaSelectTom:linhaSelectTom,navBar:navBar,oracoesEucaristicasDiv:oracoesEucaristicasDiv,acorde_10:acorde_10,acorde_7:acorde_7,acorde_9:acorde_9,muteDiv:muteDiv,botaoMute:botaoMute,iconVolumeMute:iconVolumeMute,iconVolume:iconVolume,modal01:modal01,linksCifraClubList:linksCifraClubList,botaoIniciar:botaoIniciar,escreverCifraTextArea:escreverCifraTextArea,selectInstrumento:selectInstrumento,salvarDiv:salvarDiv,selectOpcoes:selectOpcoes,modalGravar:modalGravar,musicaSearch:musicaSearch,titulo:titulo,bateriaBotoes:bateriaBotoes,selectSalvamento:selectSalvamento,lightCompasso:lightCompasso,modal_loading:modal_loading,prepararBateriaBotao:prepararBateriaBotao,pararBateriaBotao:pararBateriaBotao,play_pause_bateria:play_pause_bateria,textoRitmo:textoRitmo,listaMusicasCifra:listaMusicasCifra,orgaoBox:orgaoBox,notaTuner:notaTuner,tunerDiv:tunerDiv,autoTunerCheck:autoTunerCheck,liturgiaDiariaDiv:liturgiaDiariaDiv,violinoDesenho:violinoDesenho,violaoDesenho:violaoDesenho,switchDark:switchDark,baixo:baixo,mao:mao,full:full,measureLength:measureLength,musicaAcordesTextArea:musicaAcordesTextArea,acorde_0:acorde_0,acorde_3:acorde_3,acorde_4:acorde_4,acorde_5:acorde_5,acorde_1:acorde_1,acorde_2:acorde_2,aumentarTomMais:aumentarTomMais,diminuirTomMenos:diminuirTomMenos,tomMenorSwitch:tomMenorSwitch,tituloConfiguracaoTeclas:tituloConfiguracaoTeclas,textoConfiguracao:textoConfiguracao,tecladoTeclasDiv:tecladoTeclasDiv,inputTeclaLabel:inputTeclaLabel};function esperarAudios(e,a){if(!1==a){container.style.display="block",document.getElementById("tracker-container").style.display="block",navBar.style.display="";try{carregarConfiguracoesDoStorage()}catch{}mostrarCompartilhado()}else setTimeout(function(){container.style.display="block",document.getElementById("tracker-container").style.display="block",navBar.style.display="";try{carregarConfiguracoesDoStorage()}catch{}mostrarCompartilhado()},e)}function mostrarMensagem(e){let a=document.getElementById("mensagens");a.innerText=a.innerText+"\n"+e}function capturarTeclaPressionada(e){if(_configurandoTeclas)mostrarTeclaConfiguracaoTeclas(e);else if(_teclasConfiguracao[e]&&"none"===modal01.style.display){let a=elementos[_teclasConfiguracao[e][0]],o=eventos[_teclasConfiguracao[e][1]];_teclasConfiguracao[e][0].includes("Check")&&(a.checked=!a.checked),a.dispatchEvent(o)}}function limparConfiguracaoTeclas(){confirm("Apagar as Configura\xe7\xf5es de Teclas?")&&localStorage.removeItem("teclasConfiguracao")}function limparConfiguracaoTodas(){confirm("Tem certeza? Isso excluir\xe1 os salvamentos tamb\xe9m")&&(localStorage.clear(),sessionStorage.clear(),caches.delete(),location.reload())}function mostrarSalvarConfiguracaoTeclas(){_configurandoTeclas=!0,modal01.style.display="none",tituloConfiguracaoTeclas.style.display="",document.getElementById("linhaVermelha").style.display="",titulo.style.display="none",botaoBuscar.style.display="none",play_pause.style.display="",prepararBateriaBotao.style.display="none",pararBateriaBotao.style.display=""}function ocultarGravarCifras(){_gravarCifras=!1,document.getElementById("tituloGravacaoCifras").style.display="none",document.getElementById("linhaVermelha").style.display="none",botaoBuscar.style.display="",play_pause.style.display="none",gravarCifrasControle.style.display="none",titulo.style.display="",ocultarBotoesAcompanhamentosRitmo(!1),voltarParaOrgao(),acompCheckDiv.style.display="",acompCheck.checked&&mostrarBateria()}function ocultarSalvarConfiguracaoTeclas(){ocultarGravarCifras(),_configurandoTeclas=!1,tituloConfiguracaoTeclas.style.display="none",titulo.style.display="",tecladoTeclasDiv.style.display="none",botaoBuscar.style.display="",play_pause.style.display="none",prepararBateriaBotao.style.display="",pararBateriaBotao.style.display="none"}function capturarTeclaConfiguracaoTeclas(e){_configuracaoEvento=e.getAttribute("dataEventoTecla"),selectConfiguracao.style.display="none",modal01.style.display="block",_configuracaoElemento=e.id,selectOpcoes.style.display="none",tecladoTeclasDiv.style.display=""}function verificarSeTemValor(e,a){for(let o in e)e[o][0].includes(a)&&delete e[o]}function mostrarTeclaConfiguracaoTeclas(e){inputTeclaLabel.innerText=e,botaoOkTecla.disabled=!1}function armazenarTeclaConfiguracaoTeclas(){verificarSeTemValor(_teclasConfiguracao,_configuracaoElemento);let e=inputTeclaLabel.innerText,a=[_configuracaoElemento,_configuracaoEvento];_teclasConfiguracao[e]=a,botaoOkTecla.disabled=!0,inputTeclaLabel.innerText="",ocultarModal()}function salvarConfiguracaoTeclas(){_teclasConfiguracao?(localStorage.setItem("teclasConfiguracao",JSON.stringify(_teclasConfiguracao)),ocultarSalvarConfiguracaoTeclas()):alert("Nada foi configurado. Saindo..."),carregarConfiguracaoTeclas()}function carregarConfiguracaoTeclas(){let e=localStorage.getItem("teclasConfiguracao");e&&(_teclasConfiguracao=JSON.parse(e))}function capturarTeclaGravacaoCifras(e){let a=document.getElementById("textoGravarCifras");a.value?a.value=a.value+" "+e.value:a.value=e.value}function handleTouchStart(e,a,o=!1){e.preventDefault(),a.dispatchEvent(eventoMousedown),o&&a.dispatchEvent(eventoClick)}function isMobileDevice(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}function darkModeLocalStorage(){var e=localStorage.getItem("darkMode");e&&"true"===e&&(switchDark.checked=!0,switchDark.dispatchEvent(eventoClick))}function manterTelaLigada_v2(){if(isMobileDevice()){let e=null;try{e=navigator.wakeLock.request("screen")}catch{}}}function verificarOrientacaoCelular(){isMobileDevice()&&(window.matchMedia("(orientation: portrait)").matches&&(_orientacaoCelularPe=!0),window.matchMedia("(orientation: landscape)").matches&&(_orientacaoCelularPe=!1))}function orientacaoCelularAlterado(e){0===e.target.screen.orientation.angle?(_orientacaoCelularPe=!0,"none"!==textoCifras.style.display&&mostrarNavBar()):(_orientacaoCelularPe=!1,"none"!==textoCifras.style.display&&ocultarNavBar()),"none"!==exitfullscreen.style.display&&mudarParaFullscreen(),calcularAlturaIframe()}function mostrarBateria(e=!0){e?bateriaBotoes.style.display="":bateriaBotoes.style.display="none",localStorage.setItem("acompCheck",acompCheck.checked)}function ocultarBotoesAcompanhamentoCravo(e=!0){let a=document.getElementsByClassName("trCravoBotoes");if(e){for(let o=0;o<a.length;o++)a[o].style.display="none";tdVolume.style.display="none"}else{for(let t=0;t<a.length;t++)a[t].style.display="";tdVolume.style.display=""}}function ocultarBotoesCravo(e=!0){let a=document.getElementsByClassName("trCravoBotoes");if(e){for(let o=0;o<a.length;o++)a[o].style.display="none";baixo.style.display="none",mao.style.display="none",full.style.display="none",violaoBotao.style.display="",pianoBotao.style.display="",baixoBotao.style.display=""}else{for(let t=0;t<a.length;t++)a[t].style.display="";let n=document.getElementsByClassName("botoesAcompanhamentosRitmo");for(let l=0;l<n.length;l++)n[l].style.display="";violaoBotao.style.display="none",pianoBotao.style.display="none",baixoBotao.style.display="none",baixo.style.display="",mao.style.display="",full.style.display=""}}function ocultarBotoesRitmo(e=!0){var a=document.getElementsByClassName("trBateriaBotoes");if(e)for(let o=0;o<a.length;o++)a[o].style.display="none";else for(let t=0;t<a.length;t++)a[t].style.display=""}function ocultarBotoesAcompanhamentosRitmo(e=!0){let a=document.getElementsByClassName("botoesAcompanhamentosRitmo")[0];e?(a.style.display="none",tdVolume.style.display="none"):(a.style.display="",tdVolume.style.display="")}function pressionarBotaoCravo(){var e=document.getElementsByClassName("selecionadoDrum");e.length>0&&e[0].dispatchEvent(eventoClick)}function deixarAcompanhamentoSelecionado(e){escolherAcompanhamentoOrgao(e,document.getElementById(e))}function ocultarBotaoRec(e=!0){botaoBuscar.style.display=e?"none":"block",play_pause.style.display=e?"block":"none"}function escolherAcorde(e,a){if(_configurandoTeclas){capturarTeclaConfiguracaoTeclas(a);return}_gravarCifras&&capturarTeclaGravacaoCifras(a),montarAcordeNotas(a.value),_cifraId>0&&(_cifraParado=!0,_cifraId--),a&&levantarBotoesAcordes(),""===_acordeSelecionado?(_acordeAntesSelecionado=_acordeSelecionado,pararOsAcordes(),a&&ocultarBotaoRec(!1)):(tocarAcorde(a.value,a),a&&ocultarBotaoRec())}function autoMudarRitmo(e=null,a=null){if("none"!==pararBateriaBotao.style.display&&_autoMudarRitmo||"orgao"===_instrumentoSelecionado&&_autoMudarRitmo&&"none"===prepararBateriaBotao.style.display){if(a)"brush"===e.id?(pianoBotao.classList.toggle("instrumentoSelecionado",!1),_epianoSelecionado=!1,baixoBotao.classList.toggle("instrumentoSelecionado",!1),_baixoSelecionado=!1,violaoBotao.classList.toggle("instrumentoSelecionado",!1),_violaoSelecionado=!1,stringsBotao.classList.toggle("instrumentoSelecionado",!0),_acordeSelecionado&&!_stringsSelecionado&&(_stringsSelecionado=!0,_acordeAntesSelecionado=verificarAcompanhamentoEtocar(_acordeSelecionado,_acordeAntesSelecionado,null,!0)),_guitarraSelecionado=!1,stopGuitarra()):"aro"===e.id?(pianoBotao.classList.toggle("instrumentoSelecionado",!0),_epianoSelecionado=!0,baixoBotao.classList.toggle("instrumentoSelecionado",!0),_baixoSelecionado=!0,violaoBotao.classList.toggle("instrumentoSelecionado",!1),_violaoSelecionado=!1,stringsBotao.classList.toggle("instrumentoSelecionado",!1),_stringsSelecionado=!1,pararOsAcordes(!1,!1),_guitarraSelecionado=!1,stopGuitarra()):"caixa"===e.id?(pianoBotao.classList.toggle("instrumentoSelecionado",!0),_epianoSelecionado=!0,baixoBotao.classList.toggle("instrumentoSelecionado",!0),_baixoSelecionado=!0,violaoBotao.classList.toggle("instrumentoSelecionado",!0),_violaoSelecionado=!0,stringsBotao.classList.toggle("instrumentoSelecionado",!1),_stringsSelecionado=!1,pararOsAcordes(!1,!1),_guitarraSelecionado=!1,stopGuitarra()):"chimbal"===e.id?(pianoBotao.classList.toggle("instrumentoSelecionado",!0),_epianoSelecionado=!0,baixoBotao.classList.toggle("instrumentoSelecionado",!0),_baixoSelecionado=!0,violaoBotao.classList.toggle("instrumentoSelecionado",!0),_violaoSelecionado=!0,stringsBotao.classList.toggle("instrumentoSelecionado",!0),_acordeSelecionado&&!_stringsSelecionado&&(_stringsSelecionado=!0,_acordeAntesSelecionado=verificarAcompanhamentoEtocar(_acordeSelecionado,_acordeAntesSelecionado,null,!0)),_stringsSelecionado=!0,_guitarraSelecionado=!1,stopGuitarra()):"meiaLua"===e.id&&(pianoBotao.classList.toggle("instrumentoSelecionado",!0),_epianoSelecionado=!0,baixoBotao.classList.toggle("instrumentoSelecionado",!0),_baixoSelecionado=!0,violaoBotao.classList.toggle("instrumentoSelecionado",!0),_violaoSelecionado=!0,stringsBotao.classList.toggle("instrumentoSelecionado",!0),_acordeSelecionado&&!_stringsSelecionado&&(_stringsSelecionado=!0,_guitarraSelecionado=!0,_acordeAntesSelecionado=verificarAcompanhamentoEtocar(_acordeSelecionado,_acordeAntesSelecionado,null,!0),playGuitarra()),_stringsSelecionado=!0,_guitarraSelecionado=!0);else if("orgao"===_instrumentoSelecionado){var o=e||document.querySelector(".selecionado");"baixo"===o.id||"mao"===o.id?brushCravo.dispatchEvent(eventoTouchstart):"full"===o.id&&cravo.dispatchEvent(eventoTouchstart)}}}function escolherAcompanhamentoBateria(botao,variavel){if(_configurandoTeclas){botao.classList.toggle("instrumentoSelecionado",!1),capturarTeclaConfiguracaoTeclas(botao);return}!1==botao.classList.contains("instrumentoSelecionado")?(eval(variavel+" = "+JSON.stringify(!0)),"_stringsSelecionado"===variavel&&_stringsParado&&""!==_acordeAntesSelecionado&&(_stringsParado=!1,(_grupoNotasStrings=montarAcorde(_acordeNotas,_acordeBaixo,_grupoNotasStrings=verificarGrupoNotasInstanciado(_grupoNotasStrings),"strings")).play()),botao.classList.toggle("instrumentoSelecionado",!0)):(eval(variavel+" = "+JSON.stringify(!1)),botao.classList.toggle("instrumentoSelecionado",!1),"epiano"!==_instrumentoSelecionado||"_stringsSelecionado"!==variavel||_stringsSelecionado||pararOsAcordes())}function escolherAcompanhamentoOrgao(e,a){if(_configurandoTeclas){capturarTeclaConfiguracaoTeclas(a);return}_acompanhamentoSelecionado=e,pressionarBotaoAcompanhamento(a),autoMudarRitmo(a)}function tocarAcorde(e,a){let o=a?a.value:e;_acordeAntesSelecionado=verificarAcompanhamentoEtocar(o,_acordeAntesSelecionado),a&&a.classList.add("pressionado")}function setTom(e="C"){tomSelect.value=e}function refinarAcorde(e){if(e.length>1&&"b"===e[1]){let a=e.slice(0,2);return e.replace(a,acidentesCorrespondentesJson[a])}return e}function getNotaBaixo(e){let a;if(e.includes("/")){let o=refinarAcorde(e.split("/")[1]);e=refinarAcorde(e.split("/")[0]),(a=_notasAcordesJson[o][0])[0].toUpperCase()!==o[0]&&(mostrarMensagem("notaBaixo errado (/): "+a),a=(_notasAcordesJson=recuperarDadosStorage("dadosLocais"))[o][0])}else(a=_notasAcordesJson[e=refinarAcorde(e)][0])[0].toUpperCase()!==e[0]&&(mostrarMensagem("notaBaixo errado: "+a),a=(_notasAcordesJson=recuperarDadosStorage("dadosLocais"))[e][0]);return[e,a]}function montarAcordeNotas(e){if(""!==e){let a=getNotaBaixo(e=e.replace("E#","F"));e=a[0],_acordeBaixo=a[1],_acordeNotas=_notasAcordesJson[e]}_acordeSelecionado=e}function montarAcorde(e,a,o,t="orgao"){if(_guitarraSelecionado&&playGuitarra(),o){if("strings"!==t||"epiano"!==_instrumentoSelecionado||!_stringsSelecionado||_violaoSelecionado||_baixoSelecionado||_epianoSelecionado||_autoMudarRitmo){if("orgao"===_instrumentoSelecionado){if("full"===_acompanhamentoSelecionado){o.addSound(acordes[t+"_"+a+"_grave"]),o.addSound(acordes[t+"_"+e[0]+"_baixo"]),o.addSound(acordes[t+"_"+e[1]+"_baixo"]),o.addSound(acordes[t+"_"+e[2]+"_baixo"]),o.addSound(acordes[t+"_"+e[0]]),o.addSound(acordes[t+"_"+e[1]]),o.addSound(acordes[t+"_"+e[2]]);for(var n=2,l=e.length;n<l;n++)o.addSound(acordes[t+"_"+e[n]])}else if("baixo"===_acompanhamentoSelecionado){o.addSound(acordes[t+"_"+a+"_grave"]),o.addSound(acordes[t+"_"+e[0]+"_baixo"]),o.addSound(acordes[t+"_"+e[1]+"_baixo"]),o.addSound(acordes[t+"_"+e[2]+"_baixo"]);for(var n=2,l=e.length;n<l;n++)o.addSound(acordes[t+"_"+e[n]+"_baixo"])}else{o.addSound(acordes[t+"_"+a]),o.addSound(acordes[t+"_"+e[1]]),o.addSound(acordes[t+"_"+e[2]]);for(var n=2,l=e.length;n<l;n++)o.addSound(acordes[t+"_"+e[n]])}o.attack=.1}else{"strings"===t&&"orgao"===_instrumentoSelecionado&&o.addSound(acordes[t+"_"+a+"_grave"]),o.addSound(acordes[t+"_"+e[0]+"_baixo"]),o.addSound(acordes[t+"_"+e[1]+"_baixo"]),o.addSound(acordes[t+"_"+e[2]+"_baixo"]),o.addSound(acordes[t+"_"+e[0]]),o.addSound(acordes[t+"_"+e[1]]),o.addSound(acordes[t+"_"+e[2]]);for(var n=2,l=e.length;n<l;n++)o.addSound(acordes[t+"_"+e[n]])}}else o.addSound(acordes["strings_"+e[0]]),o.addSound(acordes["strings_"+e[0]+"_baixo"]),o.addSound(acordes["strings_"+e[0]+"_grave"])}return o}function verificarGrupoNotasInstanciado(e){return e||((e=new Pizzicato.Group).volume=_volume),e}function verificarAcompanhamentoEtocar(e,a,o=null,t=!1){if(a===e?(pararOsAcordes(!0,null!=o?o:_stringsSelecionado),esperar=50):pararOsAcordes(!0),a=e,montarAcordeNotas(e),"epiano"!==_instrumentoSelecionado||_violaoSelecionado||_epianoSelecionado||_baixoSelecionado||_stringsSelecionado||(stringsBotao.classList.toggle("instrumentoSelecionado",!0),_stringsSelecionado=!0),"none"===iconVolumeMute.style.display){if(_stringsSelecionado&&(_stringsParado=!1,montarAcorde(_acordeNotas,_acordeBaixo,_grupoNotasStrings=verificarGrupoNotasInstanciado(_grupoNotasStrings),"strings").play()),_epianoSelecionado&&"epiano"===_instrumentoSelecionado&&!t)_grupoNotas=verificarGrupoNotasInstanciado(_grupoNotas),montarAcorde(_acordeNotas,_acordeBaixo,_grupoNotas,"epiano").play();else if("orgao"===_instrumentoSelecionado){_grupoNotas=verificarGrupoNotasInstanciado(_grupoNotas);let n=montarAcorde(_acordeNotas,_acordeBaixo,_grupoNotas,_instrumentoSelecionado);setTimeout(()=>{n.play()},60)}}return a}function pararOsAcordes(e=!1,a=!1){if(_somSolo&&(_somSolo.stop(),_notasSolo=null),_grupoNotas&&(_grupoNotas.stop(),e)){var o=_grupoNotas.sounds.length;for(let t=o-1;t>-1;t--)_grupoNotas.removeSound(_grupoNotas.sounds[t])}if(!1===a&&_grupoNotasStrings&&(_stringsParado=!0,_grupoNotasStrings.stop(),e)){var o=_grupoNotasStrings.sounds.length;for(let n=o-1;n>-1;n--)_grupoNotasStrings.removeSound(_grupoNotasStrings.sounds[n])}stopGuitarra(!0)}function levantarBotoesAcordes(){let e=document.querySelectorAll(".pressionado");e.forEach(e=>e.classList.remove("pressionado"))}function levantarBotoesAcompanhamento(){var e=document.getElementsByClassName("selecionado");for(let a=0;a<e.length;a++)e[a].classList.toggle("selecionado",!1)}function pressionarBotaoAcompanhamento(e){!1===botaoAcompPressionado(e)&&(""!==_acordeAntesSelecionado&&"epiano"!==_instrumentoSelecionado&&(_acordeAntesSelecionado=verificarAcompanhamentoEtocar(_acordeAntesSelecionado,_acordeAntesSelecionado,!1)),levantarBotoesAcompanhamento(),pressionarBotaoAcomp(e))}function botaoAcompPressionado(e){return!!e.classList.contains("selecionado")}function pressionarBotaoAcomp(e){e.classList.toggle("selecionado",!0)}function alterarVolume(e,a){_volume=parseFloat(e),_grupoNotas&&(_grupoNotas.volume=_volume),_grupoNotasStrings&&(_grupoNotasStrings.volume=_volume),e===a?volumeTexto.innerHTML=10*e:volumeTexto.innerHTML=10*e+"*"}function mudarTomCifra(e,a){_tomSelectedIndexCifra=tomSelect.selectedIndex;let o=AlterarTom(textoCifras.contentDocument.body.innerHTML,e,a);o.success?(textoCifras.contentDocument.body.innerHTML=o.message,addEventCifras(textoCifras,_cifraId-1)):alert(o.message)}function mudarTom(e){if(!e){tomSelect.value=acorde_0.value;return}var a=acordesCampoHarmonicoJson[e];Array.from(document.getElementsByClassName("acorde")).forEach(e=>{var o=e.id.split("_")[1];e.value=a[o]});var o=document.getElementsByClassName("pressionado");if(o.length>0){var t=o[0];escolherAcorde(t.value,t)}mudarTomMenor(tomSelect.selectedIndex),"none"===textoCifrasFrame.style.display&&localStorage.setItem("tomSelecionadoIndex",tomSelect.selectedIndex)}function mudarTomMenor(e){textoAcordeMenor.innerText=acordesTons[e+12]}function aumentarTom(e,a,o){if(_configurandoTeclas){capturarTeclaConfiguracaoTeclas(document.activeElement);return}var t=document.getElementById(o),n=t.selectedIndex;if(t.value.includes("m"))var l=tonsMenores;else var l=tonsMaiores;e?n+a===t.length?t.value=l[0]:n+a>t.length?t.value=l[-1+a]:t.value=l[n+a]:n-a<0?0===n?t.value=l[t.length-a]:t.value=l[t.length-1]:t.value=l[n-a],"none"!==textoCifrasFrame.style.display&&"none"===liturgiaDiariaFrame.style.display?mudarTomCifra(e,a):mudarTom(t.value)}function adicionarTonsSelect(e,a,o){var t=document.getElementById(e);t.innerHTML="";var n=tonsMaiores;!1===o&&(n=tonsMenores);for(var l=0;l<n.length;l++){let r=document.createElement("option");r.value=n[l],r.textContent+=n[l],t.appendChild(r)}t.selectedIndex=a,textoAcordeMenor.innerText=tonsMenores[a]}function mostrarTextoCifrasCarregado(e=null,a=null){e&&(e.includes("m")?adicionarTonsSelect("tomSelect",tonsMenores.indexOf(e),!1):adicionarTonsSelect("tomSelect",tonsMaiores.indexOf(e),!0),_tomSelectedIndexCifra=tomSelect.selectedIndex),a&&(textoCifras.contentDocument.body.innerHTML=a),document.body.classList.contains("bg-dark")?textoCifras.contentWindow.document.querySelector("pre").style.color="#fff":textoCifras.contentWindow.document.querySelector("pre").style.color="#000","none"===textoCifrasFrame.style.display&&mudarParaTelaFrame(),addEventCifras(textoCifras),mudarTamanhoFrameCifras(_orientacaoCelularPe)}function selecionarCifraId(){var e=textoCifras.contentDocument.getElementsByClassName("cifraSelecionada");if(e.length>0)return _cifraId=e[0].id.split("cifra")[1]-1,e[0]}function mudarParaTelaFrame(){textoCifrasFrame.style.display="block",textoCifras.style.display="",document.getElementById("liturgiaDiariaFrame").style.display="none";for(var e=document.getElementsByClassName("orgaoBotoes"),a=0;a<e.length;a++)e[a].style.display="none";container.classList.remove("d-sm-flex"),volumeDiv.style.display="none",voltar.style.display="block",botaoFonte.style.display="block",selectFonte.style.display="none",tomMenorSwitchDiv.style.display="none",orgaoCifrasBotoes.style.display="",tdVolume.setAttribute("rowspan",""),tdVolume.setAttribute("colspan",5),volumeDiv.style.display="block",textoVolume.classList.remove("textoVertical"),volumeInput.setAttribute("orient",""),$("#tdVolume").appendTo("#tableOrgao"),$("#textoVolume").prependTo("#volumeDiv"),$("#orgaoTable").prependTo("#bateriaBox"),!1===_orientacaoCelularPe&&ocultarNavBar(),calcularAlturaIframe()}function addEventCifras(e,a){for(var o=e.contentDocument.getElementsByTagName("b"),t=0;t<o.length;t++)o[t].addEventListener("click",function(e){var a=textoCifras.contentDocument.getElementsByClassName("cifraSelecionada");a.length>0&&a[0].classList.remove("cifraSelecionada"),e.target.classList.add("cifraSelecionada"),e.target.scrollIntoView(),parent.tocarCifraManualmente(e.target),parent.focus()});if(-1===a&&(a=0),a>=0){let n=o[a];(n||n>=0)&&(n.classList.add("cifraSelecionada"),_cifraParado||(_acordeAntesSelecionado=verificarAcompanhamentoEtocar(n.innerText,_acordeAntesSelecionado)))}}function tocarCifraManualmente(e){_cifraId=e.id.split("cifra")[1]-1,!1===_cifraParado&&avancarCifra("avancar",cifraAvancar)}function tocarSolo(e){_acordeSelecionado=(_notasSolo=e.split("."))[0],tocarAcorde(_notasSolo[0],null),_notasSolo&&_notasSolo.shift()}function avancarCifra(e,a){if(_configurandoTeclas){capturarTeclaConfiguracaoTeclas(a);return}if(""===e)escolherAcorde("",a),botaoBuscar.style.display="block",play_pause.style.display="none";else if("repetir"===e)!1===_cifraParado&&(_acordeAntesSelecionado=verificarAcompanhamentoEtocar(_acordeAntesSelecionado,_acordeAntesSelecionado,50));else{var o=textoCifras.contentDocument,t=o.getElementsByTagName("b"),n=o.getElementsByClassName("cifraSelecionada");if("avancar"===e&&_cifraId<t.length){n.length>0&&n[0].classList.remove("cifraSelecionada"),_cifraParado=!1;let l=t[_cifraId],r=l.innerHTML.trim();r.includes(".")?tocarSolo(r):tocarAcorde(r,null),cifraRetroceder.classList.contains("pressionado")&&cifraRetroceder.classList.remove("pressionado"),a.classList.toggle("pressionado",!0),l.classList.add("cifraSelecionada"),l.scrollIntoView(),_cifraId++}if("retroceder"===e&&_cifraId-1>0){n.length>0&&n[0].classList.remove("cifraSelecionada"),!1===_cifraParado&&_cifraId--;var s=t[_cifraId-1];tocarAcorde(s.innerHTML.trim(),null),cifraAvancar.classList.contains("pressionado")&&cifraAvancar.classList.remove("pressionado"),a.classList.toggle("pressionado",!0),s.classList.add("cifraSelecionada"),s.scrollIntoView()}botaoBuscar.style.display="none",play_pause.style.display="block"}}function mudarTamanhoFrameCifras(e){textoCifras.contentWindow.document.querySelector("pre").style.fontSize=selectFonte.value+"px"}function rolagemTelaOracaoEucaristica(e=!0){if("none"!==oracoesEucaristicasDiv.style.display){var a="scrollOracoesEuc";if(e)localStorage.setItem(a,modal01.scrollTop);else{var o=localStorage.getItem(a);o&&modal01.scrollTo(0,parseInt(o))}}}function posicaoBotaoFecharModal(e,a){a?(e.style.position="fixed",e.style.top=_spanBotaoFecharModalPositions.top+"px",e.style.left=_spanBotaoFecharModalPositions.right+"px"):(e.style.position="",e.style.top="",e.style.left="")}function mostrarLiturgiaDiaria(){modal01.style.display="none",voltarParaOrgao(),textoCifrasFrame.style.display="block",textoCifras.style.display="none",document.getElementById("liturgiaDiariaFrame").style.display="",container.classList.remove("d-sm-flex"),volumeDiv.style.display="none",voltar.style.display="block",tdVolume.setAttribute("rowspan",""),tdVolume.setAttribute("colspan",5),volumeDiv.style.display="block",textoVolume.classList.remove("textoVertical"),volumeInput.setAttribute("orient",""),$("#tdVolume").appendTo("#tableOrgao"),$("#textoVolume").prependTo("#volumeDiv"),$("#orgaoTable").prependTo("#bateriaBox"),calcularAlturaIframe()}function voltarParaOrgao(){voltar.style.display="none",botaoFonte.style.display="none",selectFonte.style.display="none",orgaoCifrasBotoes.style.display="none",textoCifrasFrame.style.display="none",tomMenorSwitchDiv.style.display="";for(var e=document.getElementsByClassName("orgaoBotoes"),a=0;a<e.length;a++)e[a].style.display="";container.classList.add("d-sm-flex"),tdVolume.setAttribute("rowspan",5),tdVolume.setAttribute("colspan",""),volumeDiv.style.display="flex",textoVolume.style.display="",textoVolume.classList.add("textoVertical"),volumeInput.setAttribute("orient","vertical"),$("#tdVolume").appendTo("#orgaoControle"),$("#textoVolume").appendTo("#volumeDiv"),$("#orgaoTable").appendTo("#orgaoBox"),mostrarNavBar(),adicionarTonsSelect("tomSelect",0,!0),ultimoTomSelecionadoStorage()}function mudarParaFullscreen(){exitfullscreen.style.display="flex",botaoFullscreen.style.display="none",bateria.style.display="none",switchDarkDiv.style.display="none",muteDiv.style.display="","none"!==textoCifras.style.display&&!1===_orientacaoCelularPe&&isMobileDevice()&&ocultarNavBar();var e=document.body,a=e.requestFullScreen||e.webkitRequestFullScreen||e.mozRequestFullScreen||e.msRequestFullScreen;a&&a.call(e)}function sairDeFullscreen(){let e="none"!==exitfullscreen.style.display;return"none"!==exitfullscreen.style.display&&("none"===textoCifrasFrame.style.display&&mostrarNavBar(),exitfullscreen.style.display="none",botaoFullscreen.style.display="flex",switchDarkDiv.style.display="",muteDiv.style.display="none",document.exitFullscreen(),linhaSelectTom.classList.add("d-flex"),mutarVolume(!1)),e}function mostrarNavBar(){$("#fullscreenDiv").prependTo("#linhaNavBar"),$("#botaoOpcoes").prependTo("#linhaNavBar"),$("#titulo").appendTo("#linhaNavBar"),$("#botaoSalvar").appendTo("#linhaNavBar"),$("#switchDarkDiv").appendTo("#linhaNavBar"),$("#muteDiv").appendTo("#linhaNavBar"),navBar.style.display="block"}function ocultarNavBar(){$("#titulo").prependTo("#linhaSelectTom"),$("#fullscreenDiv").prependTo("#linhaSelectTom"),$("#botaoOpcoes").prependTo("#linhaSelectTom"),$("#botaoSalvar").appendTo("#linhaSelectTom"),$("#muteDiv").appendTo("#linhaSelectTom"),navBar.style.display="none"}function ultimoTomSelecionadoStorage(){var e=localStorage.getItem("tomSelecionadoIndex");e&&(tomSelect.selectedIndex=e,tomSelect.dispatchEvent(new Event("change")))}function recuperarDadosStorage(e){let a=localStorage.getItem("notasAcordesJson");return a?JSON.parse(a):notasAcordesJson}function salvarDadosStorage(e){let a=JSON.stringify({notasAcordesJson:notasAcordesJson});localStorage.setItem(e,a)}function carregarConfiguracoesDoStorage(){selecionarInstrumento(),darkModeLocalStorage(),adicionarTonsSelect("tomSelect",0,!0),ultimoTomSelecionadoStorage();let e=localStorage.getItem("acompCheck");e&&"true"===e?(acompCheck.checked=!0,acompCheck.dispatchEvent(eventoClick),mostrarBateria(!0)):acompCheck.checked=!1;let a=localStorage.getItem("instrumentoSelecionadoIndex");a&&(instrumentoSelect.selectedIndex=a,instrumentoSelect.dispatchEvent(eventoChange),_instrumentoSelecionado=instrumentoSelect.value.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().replace("banda","epiano")),gerarRitmosNomes(ritmosNomes),selecionarRitmo(selectRitmo.value)}function ativarBotao(e){e.classList.add("ativado")}function desativarBotao(e){e.classList.remove("ativado")}function voltarIconeOriginal(){_chimesPressionado=!1,clearTimeout(timer),iconPrato.style.display="none",iconPratoCravo.style.display="none",iconChimes.style.display="",iconChimesCravo.style.display="",desativarBotao(prato),desativarBotao(pratoCravo)}function mudarIconeAposTempo(){_chimesPressionado&&(iconChimes.style.display="none",iconChimesCravo.style.display="none",iconPrato.style.display="",iconPratoCravo.style.display="",chimesSound.stop(),pratoSound.play())}function mudarIconeChimesPrato(){setTimeout(function(){_chimesPressionado=!0,chimesSound.play()},180),timer=setTimeout(mudarIconeAposTempo,180)}function selecionarTomMenor(e){e?(textoAcordeMenor.style.color="black",tomSelect.style.color="grey",acorde_10.style.display="block",acorde_7.style.display="block",acorde_9.style.display="block"):(textoAcordeMenor.style.color="grey",tomSelect.style.color="black",acorde_10.style.display="none",acorde_7.style.display="none",acorde_9.style.display="none")}function aumentarTom_click(e){timer&&clearTimeout(timer),timer=setTimeout(function(){aumentarTom(e,1,"tomSelect")},240)}function aumentarTom_clickDuplo(e){clearTimeout(timer),aumentarTom(e,2,"tomSelect")}function showselectFonte(e){e?(botaoFonte.style.display="none",selectFonte.style.display=""):"none"!==textoCifras.style.display&&(textoCifras.contentWindow.document.querySelector("pre").style.fontSize=selectFonte.value+"px")}function showselectIframe(e){}function prepararMudarTomCifra(e){if("none"!==salvarDiv.style.display&&"none"===modal01.style.display){if("none"===textoCifrasFrame.style.display)mudarTom(e);else{if(e.includes("m"))var a=tonsMenores.indexOf(e);else var a=tonsMaiores.indexOf(e);(a-=_tomIndex)<0?mudarTomCifra(!1,Math.abs(a)):mudarTomCifra(!0,a)}}}function pegarTomCifra(e){_tomIndex=e.includes("m")?tonsMenores.indexOf(e):tonsMaiores.indexOf(e)}function primeiraLetraMaiuscula(e){return e?e.charAt(0).toUpperCase()+e.slice(1):e}function isPar(e){return e%2==0}function AlterarTom(e,a,o){try{a||(o*=-1);var t=GetAcordes(e,o);return{success:!0,message:t}}catch(n){return{success:!1,message:n.message}}}function EditarCifra(e){try{var a=SearchAcordes(e);return{success:!0,message:a}}catch(o){return{success:!1,message:o.message}}}function GetAcordes(e,a=0){if(!e.includes("<b"))return SearchAcordes(e);for(var o=e.split("<b"),t=[],n=0;n<o.length;n++)if(0===n)t.push(o[n]);else{var l=o[n].split(">")[1].split("<")[0],r=o[n].split("<")[1],s=l,c=GetAcorde(s),d=c[0],u=c[1];for(s=d,u.includes("/")||(s+=u);!notasAcordes.includes(s);)s=s.substring(0,s.length-1);u.includes("/")&&(s+=u),""!==s?(0!==a&&(s=MudarCifraTom(a,d),u.includes("/")&&(u="/"+MudarCifraTom(a,u.split("/")[1])),s+=u),s=">"+s+"<"+r,t.push('<b id="cifra'+n+'"'+s)):t.push("       "+r)}return t.join("")}function GetAcorde(e){var a=e=e.replace("(9)","9").replace("m(5-)","\xb0").replace("m7(5-)","\xb07").replace("\xba","\xb0"),o="",t="";e.includes("(")&&(a=e.split("(")[0]),e.includes("/")&&!e.includes("(")&&(a=e.split("/")[0],t="/"+GetAcorde(e.split("/")[1])[0]);var n=a;return n.length>1&&(n="#"===n[1]?n[0]+"#":"b"===n[1]?n[0]+"b":n[0],""===o&&(o=a.split(n)[1]),n=acidentesCorrespondentesJson[n]),[n,o+t]}function MudarCifraTom(e,a){var o=tonsMaiores.indexOf(a);return(o+=e)>11?o-=12:o<0&&(o+=12),tonsMaiores[o]}function SearchNotasSolo(e){let a=e,o=[];if(e.includes(".")){let t=e.split(".");a=t[0],t[0]="",t.length>=1&&t.forEach(function(e){let a=e.includes("0")?"0":e.includes("-1")?"-1":"",t=a?e.split(a)[0]:e,n=_acidentesCorrespondentesJson[t=t.length>1&&"b"===t[1]?t[0].toUpperCase()+"b":t.toUpperCase()];o.push(n?n.toLowerCase()+a:"")})}return[a,o?o.join("."):""]}function SearchAcordes(e){let a=e.split("\n"),o=[],t=/^[A-Ga-g0-9mM#bsus°º+/()| \.]*$/,n=/\b[A-G()]/,l=1;return o.push("<style>.cifraSelecionada{background-color:#ff0}pre{line-height:1.6;font-size:14px}</style><pre>"),a.forEach(function(e){let a=e.replace("[Intro]","").replace("[Solo]","").replace("[Final]","");e&&t.test(a)?(e.split(" ").forEach(function(e){if(e&&t.test(e)&&n.test(e)){let a=SearchNotasSolo(e);e=a[0];let r=a[1],s;"("===e[0]?(o.push("("),s=GetAcorde(e.split("(")[1].replace("|",""))):")"===e[0]?(o.push(")"),s=GetAcorde(e.split(")")[1].replace("|",""))):e.endsWith(")")?(o.push(")"),s=GetAcorde(e.split(")")[0].replace("|",""))):e.endsWith("(")?(o.push("("),s=GetAcorde(e.split("(")[0].replace("|",""))):s=GetAcorde(e.replace("|",""));let c,d=s[0]+s[1],u=d;for(e.includes("/")&&(u=u.split("/")[0]);!notasAcordes.includes(u)&&""!==(d=d.substring(0,d.length-1)););d?(d=">"+d+r+"</b>",o.push('<b id="cifra'+l+'"'+d),o.push(" "),l++):o.push("")}else o.push(e+" ")}),o.push("\n")):o.push(e+"\n")}),"\n"===o[o.length-1]&&o.pop()," "===o[o.length-1]&&o.pop(),o.push("</pre>"),o.join("")}function mudarTamanhoModal(e){if(e){var a=window.innerHeight/1.15;document.getElementById("liturgiaDiariaFrame").style.height=a+"px"}}function mutarVolume(e=!0){if(_configurandoTeclas){capturarTeclaConfiguracaoTeclas(botaoMute);return}!1===e?(volumeInput.value=.9,volumeInput.dispatchEvent(eventoInput),iconVolume.style.display="",iconVolumeMute.style.display="none"):"none"===iconVolumeMute.style.display?(volumeInput.value=0,volumeInput.dispatchEvent(eventoInput),iconVolume.style.display="none",iconVolumeMute.style.display=""):(volumeInput.value=.9,volumeInput.dispatchEvent(eventoInput),iconVolume.style.display="",iconVolumeMute.style.display="none")}function limparUrl(){let e=window.location.href;window.location.href.includes("#")&&(e=window.location.href.split("#")[0]),window.location.href.includes("?")&&(e=window.location.href.split("?")[0]),window.history.replaceState({},document.title,e)}function ocultarModal(){rolagemTelaOracaoEucaristica(),document.getElementById("liturgiaDiariaFrame").style.height="",modal01.style.display="none",linksCifraClubList.style.display="none",botaoIniciar.style.display="",escreverCifraTextArea.style.display="",oracoesEucaristicasDiv.style.display="none",salvarDiv.style.display="none",sobreDiv.style.display="none",posicaoBotaoFecharModal(document.getElementById("botaoFecharModal"),!1),limparUrl(),mostrarAfinador(!1)}function mostrarModal(e){switch(modal01.style.display="block",e){case"opcoes":_configurandoTeclas?ocultarSalvarConfiguracaoTeclas():_gravarCifras&&ocultarGravarCifras(),_spanBotaoFecharModalPositions=document.getElementById("spanBotaoFecharModal").getBoundingClientRect(),selectInstrumento.style.display="none",modalGravar.style.display="none",selectOpcoes.style.display="block",salvarDiv.style.display="none",compartilharDiv.style.display="none",selectConfiguracao.style.display="none";break;case"instrumento":selectOpcoes.style.display="none",modalGravar.style.display="none",selectInstrumento.style.display="block",salvarDiv.style.display="none",compartilharDiv.style.display="none",selectConfiguracao.style.display="none";break;case"gravar":"none"===textoCifrasFrame.style.display&&""!==textoCifras.contentDocument.body.innerHTML?(escreverCifraTextArea.style.display="block",linksCifraClubList.style.display="none",textoCifrasFrame.style.display="",musicaAcordesTextArea.value=textoCifras.contentDocument.body.innerText,textoCifrasFrame.style.display="none"):(selectOpcoes.style.display="none",selectInstrumento.style.display="none",salvarDiv.style.display="none",compartilharDiv.style.display="none",selectConfiguracao.style.display="none","none"!==textoCifras.style.display&&""!==textoCifras.contentDocument.body.innerHTML&&(textoCifras.style.display="",musicaAcordesTextArea.style.fontSize="13px",musicaAcordesTextArea.value=textoCifras.contentDocument.body.innerText,formFile.value&&(textoCifras.style.display="none"))),modalGravar.style.display="block";break;case"salvar":if(_configurandoTeclas){let a=sairDeFullscreen();confirm("Salvar Configura\xe7\xe3o de Teclas?")&&salvarConfiguracaoTeclas(),ocultarModal(),a&&botaoFullscreen.dispatchEvent(eventoClick);break}if(selectOpcoes.style.display="none",selectInstrumento.style.display="none",modalGravar.style.display="none",compartilharDiv.style.display="none",selectConfiguracao.style.display="none",salvarDiv.style.display="",""===selectSalvamento.value){let o=localStorage.getItem("salvamentosv2"),t=localStorage.getItem("compartilhados");o&&t?compartilhadoDiv.style.display="block":compartilhadoDiv.style.display="none",o?carregarSalvamentosList("salvamentosv2"):t&&carregarSalvamentosList("compartilhados")}break;case"compartilhado":let n=localStorage.getItem("fileId"),l=localStorage.getItem("nomeCompartilhamento");if(n&&"undefined"!==n){selectOpcoes.style.display="none",selectInstrumento.style.display="none",modalGravar.style.display="none",salvarDiv.style.display="none",compartilharDiv.style.display="block",selectConfiguracao.style.display="none";let r=document.location.href.replace("#","").replace("?compartilhado=1",""),s=`https://drive.google.com/file/d/${n}/view`;document.getElementById("arquivoIdText").innerText=r+"?compartilhado="+n,document.getElementById("arquivoIdLink").innerText=s,document.getElementById("arquivoIdLink").href=s,l&&(document.getElementById("nomeCompartilhamentoSpan").innerText='"'+l+'":')}break;case"oracoesEucaristicas":oracoesEucaristicasDiv.style.display="",selectOpcoes.style.display="none",rolagemTelaOracaoEucaristica(!1),posicaoBotaoFecharModal(document.getElementById("botaoFecharModal"),!0);break;case"liturgiaDiaria":textoCifrasFrame.style.display="none",textoCifras.style.display="none",document.getElementById("liturgiaDiariaFrame").style.display="",selectOpcoes.style.display="none",ocultarModal();break;case"sobre":sobreDiv.style.display="",selectOpcoes.style.display="none";break;case"configuracao":mostrarSalvarConfiguracaoTeclas();break;case"configuracaoOpcoes":selectConfiguracao.style.display="",selectOpcoes.style.display="none"}}function mostrarAfinador(e=!0){e?(tunerDiv.style.display="",autoTunerCheck.checked?(autoTunerCheck.checked=!1,tunerDiv.style.display="none"):autoTunerCheck.checked=!0,autoTunerCheck.dispatchEvent(eventoClick)):(tunerDiv.style.display="none",autoTunerCheck.checked=!1,autoTunerCheck.dispatchEvent(eventoClick))}function selecionarInstrumento(e=!1,a=!1){a&&localStorage.setItem("instrumentoSelecionadoIndex",instrumentoSelect.selectedIndex);var o=instrumentoSelect.value;let t=[brush,aro,caixa,chimbal,meiaLua,prato];titulo.innerText=o+" ▼",modal01.style.display="none",orgaoBox.style.display="",tunerDiv.style.display="none",Array.from(t).forEach(e=>{e.style.width="77px",e.style.height="44px",e.style.margin="8px"}),document.getElementsByClassName("centralizado-no-container")[1].style.width="300px",e&&(""===selectRitmo.value?bateriaBotoes.style.display="none":bateriaBotoes.style.display="block"),"\xd3rg\xe3o"===o?(_cravoSelecionado=!0,ocultarBotoesRitmo(!0),ocultarBotoesCravo(!1)):(_cravoSelecionado=!1,ocultarBotoesRitmo(!1),ocultarBotoesCravo(!0)),mudarTempoCompasso()}function calcularAlturaIframe(){var e=document.getElementById("bateriaBox").offsetHeight+linhaSelectTom.offsetHeight;"none"!==navBar.style.display&&(e+=navBar.offsetHeight,e+=30),document.documentElement.style.setProperty("--element-height",e+"px")}function gravarCifra(){_gravarCifras=!0,document.getElementById("tituloGravacaoCifras").style.display="",document.getElementById("linhaVermelha").style.display="",modal01.style.display="none",mostrarBateria(!1),acompCheckDiv.style.display="none",botaoBuscar.style.display="none",play_pause.style.display="",instrumentoSelect.selectedIndex=0,instrumentoSelect.dispatchEvent(eventoChange),titulo.style.display="none",gravarCifrasControle.style.display="",orgaoCifrasBotoes.style.display="",ocultarBotoesAcompanhamentosRitmo()}function iniciarCifra(){if(""!==musicaAcordesTextArea.value){modal01.style.display="none",modal_loading.style.display="block";let e=EditarCifra(musicaAcordesTextArea.value);e.success?(musicaAcordesTextArea.value="",mudarParaTelaCifras(e)):alert(e.message),modal_loading.style.display="none"}}function novoSalvamento(){let e,a=localStorage.getItem("salvamentosv2"),o=localStorage.getItem("compartilhados");a&&o?e=document.getElementById("selectConjuntoSalvamento").value:a?e="salvamentosv2":o&&(e="compartilhados");let t=sairDeFullscreen();var n=selectSalvamento;let l=prompt("Nome do novo salvamento");if(""!==l&&null!==l){if(l=primeiraLetraMaiuscula(l.trim()),[...n.options].map(e=>e.value).includes(l))alert("Salvamento "+l+" j\xe1 existe!");else{var r=document.createElement("option");r.text=l,n.add(r),n.selectedIndex=n.length-1,salvarSalvamento(n.value,e)}}t&&botaoFullscreen.dispatchEvent(eventoClick)}function trocarSalvamento(){let e=localStorage.getItem("compartilhados");e&&confirm("SUBSTITUIR conjunto Salvamento (local) por Compartilhado?")&&(localStorage.setItem("salvamentosv2",e),localStorage.removeItem("compartilhados"),ocultarModal())}function deletarSalvamento(e=!1){var a=document.getElementById("selectConjuntoSalvamento").value;if(e)a&&confirm("Apagar TODOS os salvamentos deste conjunto?")&&(localStorage.removeItem(a),ocultarModal());else{a||(a="salvamentosv2");var o=selectSalvamento;if(""!==o.value){let t=sairDeFullscreen();if(confirm("Apagar salvamento?\n"+o.value)){var n=getSalvamentos(a);delete n[o.value],0===Object.keys(n).length?localStorage.removeItem(a):localStorage.setItem(a,JSON.stringify(n))}t&&botaoFullscreen.dispatchEvent(eventoClick),carregarSalvamentosList(a)}}}function editarSalvamento(){let e,a=localStorage.getItem("salvamentosv2"),o=localStorage.getItem("compartilhados");a&&o?e=document.getElementById("selectConjuntoSalvamento").value:a?e="salvamentosv2":o&&(e="compartilhados");var t=selectSalvamento;if(""!==t.value){let n=sairDeFullscreen(),l=prompt("Novo nome do salvamento\n"+t.value);if(""!==l&&null!==l){if(l=primeiraLetraMaiuscula(l.trim()),[...t.options].map(e=>e.value).includes(l))alert("Salvamento "+l+" j\xe1 existe!");else{var r=getSalvamentos(e);r[l]=r[t.value],delete r[t.value],localStorage.setItem(e,JSON.stringify(r)),carregarSalvamentosList(e),t.selectedIndex=t.length-1}}n&&botaoFullscreen.dispatchEvent(eventoClick)}}function salvarOptionsNoStorage(e){(opcoesArray=[...opcoesSelect=selectSalvamento.options].map(e=>e.value)).shift(),localStorage.setItem(e,JSON.stringify(opcoesArray))}function getSalvamentos(e){var a=localStorage.getItem(e);return a?JSON.parse(a):{}}function carregarSalvamentosList(e){var a=getSalvamentos(e);if(a){selectSalvamento.innerHTML="";var o=document.createElement("option");o.text="",selectSalvamento.add(o),Object.keys(a).sort().forEach(function(e){var a=document.createElement("option");a.text=e,selectSalvamento.add(a)})}}function salvarSalvamentoNoStorage(e,a){var o={instrumentoSelect:instrumentoSelect.selectedIndex,selectRitmo:selectRitmo.selectedIndex,tomSelect:tomSelect.selectedIndex,bpm:bpm.value,autoCheck:autoCheck.checked,acompCheck:acompCheck.checked},t=document.getElementsByClassName("selecionado");t.length>0&&(o[t[0].id]="selecionado"),"none"!==tomMenorSwitchDiv.style.display&&(o.tomMenorSwitch=tomMenorSwitch.checked),"none"!==textoCifrasFrame.style.display&&(o.frameTom=tomSelect.value,o.frameCifra=textoCifras.contentDocument.body.innerHTML);var n=JSON.parse(localStorage.getItem(a))||{};n[e]=o,localStorage.setItem(a,JSON.stringify(n)),modal01.style.display="none"}function salvarSalvamento(e="",a){if(!a){let o=localStorage.getItem("salvamentosv2"),t=localStorage.getItem("compartilhados");o&&t?a=document.getElementById("selectConjuntoSalvamento").value:o?a="salvamentosv2":t&&(a="compartilhados")}if(""!==e)salvarSalvamentoNoStorage(e,a);else if(""!==selectSalvamento.value){let n=sairDeFullscreen();confirm("Deseja salvar?\n"+(e=selectSalvamento.value))&&salvarSalvamentoNoStorage(e,a),n&&botaoFullscreen.dispatchEvent(eventoClick)}}function carregar_Salvamento(){voltarParaOrgao();let e=localStorage.getItem("salvamentosv2"),a=localStorage.getItem("compartilhados"),o=e;e&&a?"compartilhados"===(nomeStorage=document.getElementById("selectConjuntoSalvamento").value)&&(o=a):a&&(o=a);var t=selectSalvamento.value;if(t){var n=JSON.parse(o)[t];if(n){let l=!1;var r=Object.keys(n);if(r.includes("frameCifra")){l=!0;let s=n.frameTom,c=n.frameCifra;escreverCifraTextArea.style.display="block",mostrarTextoCifrasCarregado(s,c),textoCifras.contentWindow.document.querySelector("pre").style.fontSize=selectFonte.value+"px";let d=selecionarCifraId();d&&d.scrollIntoView()}else voltarParaOrgao();r.forEach(function(e){var a=n[e],o=document.getElementById(e);o&&"frameCifra"!==o.id&&"frameTom"!==o.id&&("bpm"===e?(o.value=a,bpmRange.value=bpm.value):"selecionado"===a?escolherAcompanhamentoOrgao(o.id,o):"tomMenorSwitch"===e||"autoCheck"===e||"acompCheck"===e?o.checked=a:o.selectedIndex=a,!1==(l&&"tomSelect"===o.id)&&o.dispatchEvent(new Event("change")))})}}ocultarModal()}function compartilhar_Salvamentos(){let e=localStorage.getItem("compartilhados");localStorage.getItem("salvamentosv2")?(modal01.style.display="none",criarArquivodoStorage("salvamentosv2")):e?(localStorage.setItem("salvamentosv2",e),modal01.style.display="none",criarArquivodoStorage("salvamentosv2")):alert("Crie pelo menos um Salvamento")}function mostrarSalvamentoCompartilhado(){let e=document.getElementById("arquivoIdText").innerText;isMobileDevice()?compartilharMobile(e):copiarTextoParaClipboard(e)}function escolherArquivo(e){let a=e.target.files;if(a.length>0){modal01.style.display="none";var o=document.getElementById("formFile"),t=o.files[0];let n=t.type;if("image/png"!==n&&"image/jpg"!==n&&"image/jpeg"!==n)alert("Selecione apenas arquivos de imagem"),o.value="";else{var l=URL.createObjectURL(t);let r=document.getElementById("partituraFrame");r.src=l,"none"===textoCifrasFrame.style.display&&mudarParaTelaFrame(),iniciarCifra(),r.style.display="",textoCifras.style.display="none"}}else partituraFrame.style.display="none",textoCifras.style.display=""}function pesquisarMusica(){modal_loading.style.display="block",listaMusicasCifra.innerHTML="";var e=musicaSearch.value;$.ajax({url:"Orgao/Pesquisar?texto="+e,type:"post",dataType:"json",success:function(e){if(e.success){escreverCifraTextArea.style.display="none",linksCifraClubList.style.display="block",botaoIniciar.style.display="none";var a=e.lista,o=e.links;if(a.length>0)for(i=0;i<a.length;i+=1)$("#listaMusicasCifra").append('<div class="list-group-item list-group-item-action" onclick="escolherLink(\''+o[i]+"')\">"+a[i]+"</div>");else alert("N\xe3o encontrado nenhuma cifra")}else alert(e.message);modal_loading.style.display="none"}})}function escolherLink(e){modal_loading.style.display="block",$.ajax({type:"post",dataType:"json",url:"Orgao/DownloadSite",data:{url:e},success:function(e){e.success?mudarParaTelaCifras(e):alert(e.message),modal_loading.style.display="none"}})}function mudarParaTelaCifras(e){escreverCifraTextArea.style.display="block",linksCifraClubList.style.display="none",botaoIniciar.style.display="",modal01.style.display="none",mostrarTextoCifrasCarregado(e.tom,e.message)}deixarAcompanhamentoSelecionado("full"),verificarOrientacaoCelular(),manterTelaLigada_v2(),carregarConfiguracaoTeclas(),_notasAcordesJson=recuperarDadosStorage("dadosLocais"),document.addEventListener("visibilitychange",function(){isMobileDevice()&&"visible"===document.visibilityState&&manterTelaLigada_v2()}),document.addEventListener("keydown",function(e){capturarTeclaPressionada(e.key)}),window.onerror=function(e,a,o,t,n){alert("Erro!\n"+e+"\nArquivo: "+a+"\nLinha: "+o+"\nPosicao: "+t)},selectRitmo.addEventListener("change",function(e){_grupoNotas=verificarGrupoNotasInstanciado(_grupoNotas)}),bpm.addEventListener("change",function(e){_grupoNotas=verificarGrupoNotasInstanciado(_grupoNotas)}),autoCheck.addEventListener("change",function(e){(_autoMudarRitmo=this.checked)?(_cravoSelecionado?ocultarBotoesAcompanhamentoCravo():ocultarBotoesAcompanhamentosRitmo(),document.getElementById("trackerControls").style.display="none"):(_cravoSelecionado?ocultarBotoesAcompanhamentoCravo(!1):ocultarBotoesAcompanhamentosRitmo(!1),document.getElementById("trackerControls").style.display=""),calcularAlturaIframe()}),instrumentoSelect.addEventListener("change",e=>{var a;_instrumentoSelecionado=instrumentoSelect.value.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().replace("banda","epiano")}),window.addEventListener("orientationchange",e=>{orientacaoCelularAlterado(e)}),musicaSearch.addEventListener("focus",function(){this.select()}),esperarAudios(3e3,!0),prato.addEventListener("mousedown",function(){ativarBotao(prato)}),prato.addEventListener("touchstart",function(){ativarBotao(prato)}),pratoCravo.addEventListener("mousedown",function(){ativarBotao(prato)}),pratoCravo.addEventListener("touchstart",function(){ativarBotao(prato)}),play_pause_bateria.addEventListener("touchstart",function(){ativarBotao(play_pause_bateria)}),play_pause_bateria.addEventListener("mouseup",function(){desativarBotao(play_pause_bateria)}),play_pause_bateria.addEventListener("touchend",function(){desativarBotao(play_pause_bateria)}),prato.addEventListener("mouseup",voltarIconeOriginal),prato.addEventListener("touchend",voltarIconeOriginal),pratoCravo.addEventListener("mouseup",voltarIconeOriginal),pratoCravo.addEventListener("touchend",voltarIconeOriginal);